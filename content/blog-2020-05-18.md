+++
title = "This Week In Veloren 68"
description = ""

date = 2020-05-18
weight = 0
slug = "devblog-68"

[extra]
banner = "https://cdn.discordapp.com/attachments/541307708146581519/712353024118358087/P0L7gSo.png"

[taxonomies]
tags = ["devblog"]
+++

\- AngelOnFira, TWiV Editor

# Contributor Work

Thanks to this week's contributors, @jbeich, @Slipped, @Silentium, @Pfau,
@xMAC94x, @imbris, @zesterer, @treeco, @Songtronix, @Shandley, @Mckol,
@mockersf, @CapsizeGlimmer, @AngelOnFira, and @Acrimon!

{{
    audio(src="https://cdn.discordapp.com/attachments/696825216868810855/712296069991497849/Leap_of_faith.ogg",
    caption="Leap of Faith by @badbbad")
}}

{{
    audio(src="https://cdn.discordapp.com/attachments/696825216868810855/712296069991497849/Leap_of_faith.ogg",
    caption="Leap of Faith by @badbbad")
}}

# 0.6 Release

{{
  img(src="https://cdn.discordapp.com/attachments/541307708146581519/712278818060238868/unknown.png",
  caption="")
}}

{{
  img(src="https://cdn.discordapp.com/attachments/541307708146581519/712278889870655558/unknown.png",
  caption="")
}}

{{
  img(src="https://cdn.discordapp.com/attachments/541307708146581519/712279233833205875/unknown.png",
  caption="")
}}

{{
  img(src="https://cdn.discordapp.com/attachments/541307708146581519/712280363862589500/unknown.png",
  caption="")
}}

{{
  img(src="https://cdn.discordapp.com/attachments/541307708146581519/712280712539275315/unknown.png",
  caption="")
}}

{{
  img(src="https://cdn.discordapp.com/attachments/541307708146581519/712281088894042132/unknown.png",
  caption="")
}}

{{
  img(src="https://cdn.discordapp.com/attachments/541307708146581519/712281641518759976/unknown.png",
  caption="")
}}

{{
  img(src="https://cdn.discordapp.com/attachments/541307708146581519/712281528167825518/unknown.png",
  caption="")
}}

Above we see persistence running on the launch party server. In the week leading
up to the launch, we started seeing many issues caused by delay in persistence.
Below you can see what the length of the delays were. This was likely caused by
the fact that normally our main server run on a unit with a hard drive, whereas
the launch party ran on a server with a solid state drive. The times taken for
saving are still quite high, since disk input/output takes significantly longer
than accessing either RAM or the CPU Cache.

{{
  img(src="https://media.discordapp.net/attachments/541307708146581519/712282870600958002/unknown.png",
  caption="")
}}

# Network Analysis by @AngelOnFira

After playing with wireshark during the NorthSec CTF last weekend, I felt
inspired to check out what Veloren's network packets look like. I started by
playing on the server, and running through a few different scenarios. First, I
started by just standing in the spawn village. Then, I started flying over
unexplored territory. Finally I fell into a lake and sank to the bottom.

{{
  img(src="https://cdn.discordapp.com/attachments/541307708146581519/712288022338732062/Screenshot_from_2020-05-19_08-50-22.png",
  caption="")
}}

## Initial Server Connection

At first, we have a high burst of data being sent and recieved while connecting
to the server. Upon analysis of the packets in that region of time, we find that
many packets are making up a larger message. This message appears to be between
30KB up to around 100KB.

## Standing in Spawn Village

Here we see two different sections. First, when you load in, you start
downloading many chunks of the surrounding area. This sees about 600KB/s of
bandwidth use. Once all of the surrounding chunks have been downloaded, the
bandwidth goes down to around 300KB/s. There are still packets being sent that
update us on all of the entities around us.

## Flying Over Unexplored Areas

Similar to the previous chunk downloading, we start asking the server for more
areas. We can see that there are some larger and smaller amounts being
downloaded. This section stays quite consistant.

## Sinking in a Lake

Finally, we see a large drop in the data being sent from the server. All of the
chunks around us have already been downloaded. Also, there aren't as many
entities around us as in the village, and so we don't get as many updates. Here
we are only seeing around 60KB/s of incoming data.

{{
  img(src="https://media.discordapp.net/attachments/541307708146581519/712334298400686163/unknown.png?width=1440&height=537",
  caption="Recived data rate from server")
}}
